# Modelfile pour Melta-82M (Clemylia/LES-IA-ETOILES)
# Configuration alignée sur le nouveau template de chat.

# --- 1. Chemin du Fichier GGUF ---
# Utilisation du chemin Hugging Face fourni
FROM hf.co/Clemylia/Melta-gguf

# --- 2. Paramètres de Génération pour la Cohérence ---
# Ces paramètres sont cruciaux pour stabiliser votre modèle de 82M.
PARAMETER temperature 0.7 
PARAMETER top_p 0.95
PARAMETER top_k 30
PARAMETER num_predict 500

# --- 3. TEMPLATE DE PROMPT (Aligné Parfaitement) ---
# Ce template reflète la structure 'Question: ... ### reponse: ... Réponse:'
TEMPLATE """
{{- range .Conversations -}}
{{- range .Messages -}}
{{- if eq .Role "user" -}}
Question:
{{ .Content }}
{{- else if eq .Role "assistant" -}}
### reponse:
{{ .Content }}
{{- end -}}
{{- end -}}
{{- end -}}
Réponse:
"""

# --- 4. Configuration du Tokenizer (Arrêt) ---
# Ceci est crucial pour empêcher le modèle de générer des boucles infinies ou des parasites.
# Nous ajoutons les délimiteurs de dialogue utilisés dans le template.
PARAMETER stop "</s>"
PARAMETER stop "</s"
PARAMETER stop "<|endoftext|>"
